<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rrd">
<title>Reading and analyzing log files in the RRD database format • rrd</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reading and analyzing log files in the RRD database format">
<meta property="og:description" content="rrd">
<meta property="og:image" content="https://andrie.github.io/rrd/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rrd</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/using_rrd.html">Reading and analyzing log files in the RRD database format</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/andrie/rrd/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="using_rrd_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Reading and analyzing log files in the RRD database format</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/andrie/rrd/blob/HEAD/vignettes/using_rrd.Rmd" class="external-link"><code>vignettes/using_rrd.Rmd</code></a></small>
      <div class="d-none name"><code>using_rrd.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/andrie/rrd/" class="external-link">rrd</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p>I have frequent conversations with R champions and Systems Administrators responsible for R, in which they ask how they can measure and analyze the usage of their servers. Among the many solutions to this problem, one of the my favourites is to use an <strong>RRD</strong> database and <strong>RRDtool</strong>.</p>
<p>From <a href="https://en.wikipedia.org/wiki/RRDtool" class="external-link">Wikipedia</a>:</p>
<blockquote>
<p><strong>RRDtool</strong> (<em>round-robin database tool</em>) aims to handle time series data such as network bandwidth, temperatures or CPU load. The data is stored in a <a href="https://en.wikipedia.org/wiki/Circular_buffer" class="external-link">circular buffer</a> based <a href="https://en.wikipedia.org/wiki/Database" class="external-link">database</a>, thus the system storage footprint remains constant over time.</p>
</blockquote>
<p><a href="https://oss.oetiker.ch/rrdtool/index.en.html" class="external-link">RRDtool</a> is a library written in C, with implementations that can also be accessed from the Linux command line. This makes it convenient for system development, but makes it difficult for R users to extract and analyze this data.</p>
<p>I am pleased to announce that I’ve been working on the <code>rrd</code> <a href="https://github.com/andrie/rrd" class="external-link">R package</a> to import RRD files directly into <code>tibble</code> objects, thus making it easy to analyze your metrics.</p>
<p>As an aside, the RStudio Pro products (specifically <a href="https://www.rstudio.com/products/rstudio-server-pro/" class="external-link">RStudio Server Pro</a> and <a href="https://www.rstudio.com/products/connect/" class="external-link">RStudio Connect</a>) also make use of RRD to store metrics – more about this later.</p>
<div class="section level2">
<h2 id="understanding-the-rrd-format-as-an-r-user">Understanding the RRD format as an R user<a class="anchor" aria-label="anchor" href="#understanding-the-rrd-format-as-an-r-user"></a>
</h2>
<p>The name RRD is an initialism of <strong>R</strong>ound <strong>R</strong>obin <strong>D</strong>atabase. The “round robin” refers to the fact that the database is always fixed in size, and as a new entry enters the database, the oldest entry is discarded. In practical terms, the database collects data for a fixed period of time, and information that is older than the threshold gets removed.</p>
<div class="figure">
<img src="rra.png" width="600" alt=""><p class="caption">Image credit: loriotpro(<a href="https://bit.ly/2tk2MFa" class="external-link uri">https://bit.ly/2tk2MFa</a>)</p>
</div>
<p>A second quality of RRD databases is that each datum is stored in different “consolidation data points”, where every data point is an aggregation over time. For example, a data point can represent an average value for the time period, or a maximum over the period. Typical consolidation functions include <code>average</code>, <code>min</code> and <code>max</code>.</p>
<p>The third quality is that every RRD database file typically consists of multiple archives. Each archive measures data for a different time period. For instance, the archives can capture data for intervals of 10 seconds, 30 seconds, 1 minute or 5 minutes.</p>
<p>As an example, here is a description of an RRD file that originated in RStudio Connect:</p>
<pre><code><span><span class="fu"><a href="../reference/describe_rrd.html">describe_rrd</a></span><span class="op">(</span><span class="st">"rrd_cpu_0"</span><span class="op">)</span></span>
<span><span class="co">#&gt; A RRD file with 10 RRA arrays and step size 60</span></span>
<span><span class="co">#&gt; [1] AVERAGE_60 (43200 rows)</span></span>
<span><span class="co">#&gt; [2] AVERAGE_300 (25920 rows)</span></span>
<span><span class="co">#&gt; [3] MIN_300 (25920 rows)</span></span>
<span><span class="co">#&gt; [4] MAX_300 (25920 rows)</span></span>
<span><span class="co">#&gt; [5] AVERAGE_3600 (8760 rows)</span></span>
<span><span class="co">#&gt; [6] MIN_3600 (8760 rows)</span></span>
<span><span class="co">#&gt; [7] MAX_3600 (8760 rows)</span></span>
<span><span class="co">#&gt; [8] AVERAGE_86400 (1825 rows)</span></span>
<span><span class="co">#&gt; [9] MIN_86400 (1825 rows)</span></span>
<span><span class="co">#&gt; [10] MAX_86400 (1825 rows)</span></span></code></pre>
<p>This <code>RRD</code> file contains data for the properties of CPU 0 of the system. In this example, the first <code>RRA</code> archive contains averaged metrics for one minute (60s) intervals, while the second <code>RRA</code> measures the same metric, but averaged over five minutes. The same metrics are also available for intervals of one hour and one day.</p>
<p>Notice also that every archive has a different number of rows, representing a different historical period where the data is kept. For example, the <em>per minute</em> data <code>AVERAGE_60</code> is retained for 43,200 periods (12 days) while the <em>daily</em> data <code>MAX_86400</code> is retained for 1,825 periods (5 years).</p>
<p>If you want to know more, please read the excellent <a href="https://oss.oetiker.ch/rrdtool/tut/rrdtutorial.en.html" class="external-link">introduction tutorial</a> to RRD database.</p>
</div>
<div class="section level2">
<h2 id="introducing-the-rrd-package">Introducing the <code>rrd</code> package<a class="anchor" aria-label="anchor" href="#introducing-the-rrd-package"></a>
</h2>
<p>Until recently, it wasn’t easy to import RRD files into R. But I was pleased to discover that a <a href="https://www.google-melange.com/archive/gsoc/2014" class="external-link">Google Summer of Code 2014</a> project created a proof-of-concept R package to read these files. The author of this package is <a href="http://plamendimitrov.net/" class="external-link">Plamen Dimitrov</a>, who published the code on <a href="https://github.com/pldimitrov/Rrd" class="external-link">GitHub</a> and also wrote an <a href="http://plamendimitrov.net/blog/2014/08/09/r-package-for-working-with-rrd-files/" class="external-link">explanatory blog post</a>.</p>
<p>Because I had to provide some suggestions to our customers, I decided to update the package, provide some example code, and generally improve the reliability.</p>
<p>The result is not yet on CRAN, but you can install the development version of package from <a href="https://github.com/andrie/rrd" class="external-link">github</a>.</p>
<div class="section level3">
<h3 id="installing-the-package">Installing the package<a class="anchor" aria-label="anchor" href="#installing-the-package"></a>
</h3>
<p>To build the package from source, you first need to install <a href="http://oss.oetiker.ch/rrdtool/doc/librrd.en.html" class="external-link">librrd</a>. Installing <a href="http://oss.oetiker.ch/rrdtool/" class="external-link">RRDtool</a> from your Linux package manager will usually also install this library.</p>
<p>Using Ubuntu:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">sudo</span> apt-get install rrdtool librrd-dev</span></code></pre></div>
<p>Using RHEL / CentOS:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">sudo</span> yum install rrdtool rrdtool-devel</span></code></pre></div>
<p>Once you have the system requirements in place, you can install the development version of the R package from <a href="https://github.com/andrie/rrd" class="external-link">GitHub</a> using:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"andrie/rrd"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="limitations">Limitations<a class="anchor" aria-label="anchor" href="#limitations"></a>
</h3>
<p>The package is not yet available for Windows.</p>
</div>
<div class="section level3">
<h3 id="using-the-package">Using the package<a class="anchor" aria-label="anchor" href="#using-the-package"></a>
</h3>
<p>Once you’ve installed the package, you can start to use it. The package itself contains some built-in RRD files, so you should be able to run the following code directly.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/andrie/rrd/" class="external-link">rrd</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="describing-the-contents-of-a-rrd">Describing the contents of a RRD<a class="anchor" aria-label="anchor" href="#describing-the-contents-of-a-rrd"></a>
</h4>
<p>To describe the contents of an RRD file, use <code><a href="../reference/describe_rrd.html">describe_rrd()</a></code>. This function reports information about the names of each archive (RRA) file, the consolidation function, and the number of observations:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rrd_cpu_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/cpu-0.rrd"</span>, package <span class="op">=</span> <span class="st">"rrd"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/describe_rrd.html">describe_rrd</a></span><span class="op">(</span><span class="va">rrd_cpu_0</span><span class="op">)</span></span>
<span><span class="co">#&gt; An RRD file with 10 RRA arrays and step size 60</span></span>
<span><span class="co">#&gt; [1] AVERAGE_60 (43200 rows)</span></span>
<span><span class="co">#&gt; [2] AVERAGE_300 (25920 rows)</span></span>
<span><span class="co">#&gt; [3] MIN_300 (25920 rows)</span></span>
<span><span class="co">#&gt; [4] MAX_300 (25920 rows)</span></span>
<span><span class="co">#&gt; [5] AVERAGE_3600 (8760 rows)</span></span>
<span><span class="co">#&gt; [6] MIN_3600 (8760 rows)</span></span>
<span><span class="co">#&gt; [7] MAX_3600 (8760 rows)</span></span>
<span><span class="co">#&gt; [8] AVERAGE_86400 (1825 rows)</span></span>
<span><span class="co">#&gt; [9] MIN_86400 (1825 rows)</span></span>
<span><span class="co">#&gt; [10] MAX_86400 (1825 rows)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="reading-an-entire-rrd-file">Reading an entire RRD file<a class="anchor" aria-label="anchor" href="#reading-an-entire-rrd-file"></a>
</h4>
<p>To read an entire RRD file, i.e. all of the RRA archives, use <code><a href="../reference/read_rrd.html">read_rrd()</a></code>. This returns a list of <code>tibble</code> objects:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cpu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_rrd.html">read_rrd</a></span><span class="op">(</span><span class="va">rrd_cpu_0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">cpu</span>, max.level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 10</span></span>
<span><span class="co">#&gt;  $ AVERAGE60   : tibble [43,199 × 9] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ AVERAGE300  : tibble [25,919 × 9] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ MIN300      : tibble [25,919 × 9] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ MAX300      : tibble [25,919 × 9] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ AVERAGE3600 : tibble [8,759 × 9] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ MIN3600     : tibble [8,759 × 9] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ MAX3600     : tibble [8,759 × 9] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ AVERAGE86400: tibble [1,824 × 9] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ MIN86400    : tibble [1,824 × 9] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ MAX86400    : tibble [1,824 × 9] (S3: tbl_df/tbl/data.frame)</span></span></code></pre></div>
<p>Since the resulting object is a list of <code>tibble</code> objects, you can easily use R functions to work with an individual archive:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cpu</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "AVERAGE60"    "AVERAGE300"   "MIN300"       "MAX300"       "AVERAGE3600" </span></span>
<span><span class="co">#&gt;  [6] "MIN3600"      "MAX3600"      "AVERAGE86400" "MIN86400"     "MAX86400"</span></span></code></pre></div>
<p>To inspect the contents of the first archive (<code>AVERAGE60</code>), simply print the object - since it’s a <code>tibble</code>, you get 10 lines of output.</p>
<p>For example, the CPU metrics contains a time stamp and metrics for average <em>user</em> and <em>sys</em> usage, as well as the <a href="https://en.wikipedia.org/wiki/Nice_(Unix)" class="external-link"><em>nice</em></a> value, <em>idle</em> time, <a href="https://en.wikipedia.org/wiki/Interrupt_request_(PC_architecture)" class="external-link"><em>interrupt requests</em></a> and <em>soft interrupt requests</em>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cpu</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 43,199 × 9</span></span></span>
<span><span class="co">#&gt;    timestamp              user     sys  nice  idle  wait   irq softirq   stolen</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2018-04-02 <span style="color: #949494;">12:24:00</span> 0.010<span style="text-decoration: underline;">4</span>  0.008<span style="text-decoration: underline;">11</span>     0 0.981     0     0       0 0.000<span style="text-decoration: underline;">137</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2018-04-02 <span style="color: #949494;">12:25:00</span> 0.012<span style="text-decoration: underline;">6</span>  0.006<span style="text-decoration: underline;">30</span>     0 0.979     0     0       0 0.001<span style="text-decoration: underline;">92</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2018-04-02 <span style="color: #949494;">12:26:00</span> 0.015<span style="text-decoration: underline;">9</span>  0.008<span style="text-decoration: underline;">08</span>     0 0.976     0     0       0 0       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2018-04-02 <span style="color: #949494;">12:27:00</span> 0.008<span style="text-decoration: underline;">53</span> 0.006<span style="text-decoration: underline;">47</span>     0 0.985     0     0       0 0       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2018-04-02 <span style="color: #949494;">12:28:00</span> 0.012<span style="text-decoration: underline;">2</span>  0.009<span style="text-decoration: underline;">99</span>     0 0.978     0     0       0 0       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2018-04-02 <span style="color: #949494;">12:29:00</span> 0.010<span style="text-decoration: underline;">6</span>  0.006<span style="text-decoration: underline;">04</span>     0 0.983     0     0       0 0       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2018-04-02 <span style="color: #949494;">12:30:00</span> 0.014<span style="text-decoration: underline;">7</span>  0.004<span style="text-decoration: underline;">27</span>     0 0.981     0     0       0 0.000<span style="text-decoration: underline;">137</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2018-04-02 <span style="color: #949494;">12:31:00</span> 0.019<span style="text-decoration: underline;">3</span>  0.007<span style="text-decoration: underline;">67</span>     0 0.971     0     0       0 0.001<span style="text-decoration: underline;">91</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2018-04-02 <span style="color: #949494;">12:32:00</span> 0.030<span style="text-decoration: underline;">0</span>  0.027<span style="text-decoration: underline;">4</span>      0 0.943     0     0       0 0       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2018-04-02 <span style="color: #949494;">12:33:00</span> 0.016<span style="text-decoration: underline;">2</span>  0.006<span style="text-decoration: underline;">17</span>     0 0.978     0     0       0 0.000<span style="text-decoration: underline;">137</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 43,189 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ Use `print(n = ...)` to see more rows</span></span></span></code></pre></div>
<p>Since the data is in <code>tibble</code> format, you can easily extract specific data, e.g., the last values of the system usage:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">cpu</span><span class="op">$</span><span class="va">AVERAGE60</span><span class="op">$</span><span class="va">sys</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.0014390667 0.0020080000 0.0005689333 0.0000000000 0.0014390667</span></span>
<span><span class="co">#&gt; [6] 0.0005689333</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="reading-only-a-single-archive">Reading only a single archive<a class="anchor" aria-label="anchor" href="#reading-only-a-single-archive"></a>
</h4>
<p>The underlying code in the <code>rrd</code> package is written in C, and is therefore blazingly fast. Reading an entire RRD file takes a fraction of a second, but sometimes you may want to extract a specific RRA archive immediately.</p>
<p>To read a single RRA archive from an RRD file, use <code><a href="../reference/read_rra.html">read_rra()</a></code>. To use this function, you must specify several arguments that define the specific data to retrieve. This includes the consolidation function (e.g., <code>"AVERAGE"</code>) and time step (e.g., <code>60</code>). You must also specify either the <code>start</code> time or the number of steps, <code>n_steps</code>.</p>
<p>In this example, I extract the average for one-minute periods (<code>step = 60</code>) for one day (<code>n_steps = 24 * 60</code>):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">end_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2018-05-02"</span><span class="op">)</span> <span class="co"># timestamp with data in example</span></span>
<span><span class="va">avg_60</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_rra.html">read_rra</a></span><span class="op">(</span><span class="va">rrd_cpu_0</span>, cf <span class="op">=</span> <span class="st">"AVERAGE"</span>, step <span class="op">=</span> <span class="fl">60</span>, n_steps <span class="op">=</span> <span class="fl">24</span> <span class="op">*</span> <span class="fl">60</span>,</span>
<span>                     end <span class="op">=</span> <span class="va">end_time</span><span class="op">)</span></span>
<span></span>
<span><span class="va">avg_60</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,440 × 9</span></span></span>
<span><span class="co">#&gt;    timestamp              user     sys  nice  idle    wait   irq softirq  stolen</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2018-05-01 <span style="color: #949494;">00:01:00</span> 0.004<span style="text-decoration: underline;">58</span> 2.01<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span>     0 0.992 0   <span style="color: #949494;"> </span>       0       0 1.44<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2018-05-01 <span style="color: #949494;">00:02:00</span> 0.002<span style="text-decoration: underline;">58</span> 5.70<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>     0 0.996 0   <span style="color: #949494;"> </span>       0       0 5.70<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2018-05-01 <span style="color: #949494;">00:03:00</span> 0.006<span style="text-decoration: underline;">33</span> 1.44<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span>     0 0.992 0   <span style="color: #949494;"> </span>       0       0 0   <span style="color: #949494;"> </span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2018-05-01 <span style="color: #949494;">00:04:00</span> 0.005<span style="text-decoration: underline;">15</span> 2.01<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span>     0 0.991 0   <span style="color: #949494;"> </span>       0       0 1.44<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2018-05-01 <span style="color: #949494;">00:05:00</span> 0.004<span style="text-decoration: underline;">02</span> 5.69<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>     0 0.995 0   <span style="color: #949494;"> </span>       0       0 5.69<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2018-05-01 <span style="color: #949494;">00:06:00</span> 0.006<span style="text-decoration: underline;">89</span> 1.44<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span>     0 0.992 0   <span style="color: #949494;"> </span>       0       0 0   <span style="color: #949494;"> </span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2018-05-01 <span style="color: #949494;">00:07:00</span> 0.003<span style="text-decoration: underline;">71</span> 2.01<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span>     0 0.993 1.44<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span>     0       0 0   <span style="color: #949494;"> </span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2018-05-01 <span style="color: #949494;">00:08:00</span> 0.004<span style="text-decoration: underline;">88</span> 2.01<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span>     0 0.993 5.69<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>     0       0 0   <span style="color: #949494;"> </span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2018-05-01 <span style="color: #949494;">00:09:00</span> 0.007<span style="text-decoration: underline;">48</span> 5.68<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>     0 0.992 0   <span style="color: #949494;"> </span>       0       0 0   <span style="color: #949494;"> </span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2018-05-01 <span style="color: #949494;">00:10:00</span> 0.005<span style="text-decoration: underline;">16</span> 0   <span style="color: #949494;"> </span>       0 0.995 0   <span style="color: #949494;"> </span>       0       0 0   <span style="color: #949494;"> </span>  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 1,430 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ Use `print(n = ...)` to see more rows</span></span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="plotting-the-results">Plotting the results<a class="anchor" aria-label="anchor" href="#plotting-the-results"></a>
</h4>
<p>The original <code>RRDTool</code> library for Linux contains some functions to <a href="https://oss.oetiker.ch/rrdtool/gallery/index.en.html" class="external-link">easily plot</a> the RRD data, a feature that distinguishes RRD from many other databases.</p>
<p>However, R already has very rich plotting capability, so the <code>rrd</code> R package doesn’t expose any specific plotting functions.</p>
<p>For example, you can easily plot these data using your favourite packages, like <code>ggplot2</code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">avg_60</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">timestamp</span>, y <span class="op">=</span> <span class="va">user</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>, span <span class="op">=</span> <span class="fl">0.125</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"CPU0 usage, data read from RRD file"</span><span class="op">)</span></span></code></pre></div>
<p><img src="using_rrd_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="getting-the-rrd-files-from-rstudio-server-pro-and-rstudio-connect">Getting the RRD files from RStudio Server Pro and RStudio Connect<a class="anchor" aria-label="anchor" href="#getting-the-rrd-files-from-rstudio-server-pro-and-rstudio-connect"></a>
</h2>
<p>As I mentioned in the introduction, both <a href="https://www.rstudio.com/products/rstudio-server-pro/" class="external-link">RStudio Server Pro</a> and <a href="https://www.rstudio.com/products/connect/" class="external-link">RStudio Connect</a> use RRD to store metrics. In fact, these metrics are used to power the administration dashboard of these products.</p>
<p>This means that often the easiest solution is simply to enable the admin dashboard and view the information there.</p>
<div class="figure">
<img src="rsp_admin_dashboard.png" width="800" alt=""><p class="caption">RStudio Server Pro admin dashboard</p>
</div>
<p>However, sometimes R users and system administrators have a need to analyze the metrics in more detail, so in this section, I discuss where you can find the files for analysis.</p>
<p>The administration guides for these products explain where to find the metrics files:</p>
<ul>
<li>The admin guide for <strong>RStudio Server Pro</strong> discusses metrics in this in section <a href="http://docs.rstudio.com/ide/server-pro/auditing-and-monitoring.html#monitoring-configuration" class="external-link">8.2 Monitoring Configuration</a>.
<ul>
<li>By default, the metrics are stored at <code>/var/lib/rstudio-server/monitor/rrd</code>, although this path is configurable by the server administrator</li>
<li>RStudio Server Pro stores system metrics as well as user metrics</li>
</ul>
</li>
<li>
<strong>RStudio Connect</strong> discusses metrics in section <a href="http://docs.rstudio.com/connect/admin/historical-information.html#metrics" class="external-link">16.1 Historical Metrics</a>
<ul>
<li>The default path for metrics logs is <code>/var/lib/rstudio-connect/metrics</code>, though again, this is configurable by the server administrator.</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rsc</span> <span class="op">&lt;-</span> <span class="st">"/var/lib/rstudio-connect/metrics/rrd"</span></span>
<span><span class="va">rsp</span> <span class="op">&lt;-</span> <span class="st">"/var/lib/rstudio-server/monitor/rrd"</span></span></code></pre></div>
<p>If you want to analyze these files, it is best to copy the files to a different location. The security and permissions on both products are configured in such a way that it’s not possible to read the files while they are in the original folder. Therefore, we recommend that you copy the files to a different location and do the analysis there.</p>
<div class="section level3">
<h3 id="warning-about-using-the-rstudio-connect-rrd-files">Warning about using the RStudio Connect RRD files:<a class="anchor" aria-label="anchor" href="#warning-about-using-the-rstudio-connect-rrd-files"></a>
</h3>
<p>The RStudio Connect team is actively planning to change the way content-level metrics are stored, so data related to shiny apps, markdown reports, etc. will likely look different in a future release.</p>
<p>To be clear:</p>
<ul>
<li>The schemas might change</li>
<li>RStudio Connect may stop tracking some metrics</li>
<li>It’s also possible that the entire mechanism might change</li>
</ul>
<p>The only guarantees that we make in RStudio Connect are around the data that we actually surface:</p>
<ul>
<li>server-wide user counts</li>
<li>RAM</li>
<li>CPU data</li>
</ul>
<p>This means that if you analyze RRD files, you should be aware that <strong>the entire mechanism for storing metrics might change in future</strong>.</p>
</div>
<div class="section level3">
<h3 id="additional-caveat">Additional caveat<a class="anchor" aria-label="anchor" href="#additional-caveat"></a>
</h3>
<ul>
<li>The metrics collection process runs in a sandboxed environment, and it is not possible to publish a report to RStudio Connect that reads the metrics directly. If you want to automate a process to read the Connect metrics, you will have to set up a <a href="https://en.wikipedia.org/wiki/Cron" class="external-link">cron</a> job to copy the files to a different location, and run the analysis against the copied files. (Also, re-read the warning that everything might change!)</li>
</ul>
</div>
<div class="section level3">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<p>In the following worked example, I copied some <code>rrd</code> files that originated in RStudio Connect to a different location on disk, and stored this in a <a href="https://github.com/rstudio/config" class="external-link"><code>config</code></a> file.</p>
<p>First, list the file names:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rrd_location</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"rrd"</span><span class="op">)</span></span>
<span><span class="va">rrd_location</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "content-1.rrd" "cpu-0.rrd"</span></span></code></pre></div>
<p>The file names indicated that RStudio Connect collects metrics for the system (CPU, RAM, etc.), as well as for every piece of published content.</p>
<p>To look at the system load, first describe the contents of the <code>"system.load.rrd"</code> file:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cpu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">rrd_location</span>, <span class="st">"cpu-0.rrd"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/describe_rrd.html">describe_rrd</a></span><span class="op">(</span><span class="va">cpu</span><span class="op">)</span></span>
<span><span class="co">#&gt; An RRD file with 10 RRA arrays and step size 60</span></span>
<span><span class="co">#&gt; [1] AVERAGE_60 (43200 rows)</span></span>
<span><span class="co">#&gt; [2] AVERAGE_300 (25920 rows)</span></span>
<span><span class="co">#&gt; [3] MIN_300 (25920 rows)</span></span>
<span><span class="co">#&gt; [4] MAX_300 (25920 rows)</span></span>
<span><span class="co">#&gt; [5] AVERAGE_3600 (8760 rows)</span></span>
<span><span class="co">#&gt; [6] MIN_3600 (8760 rows)</span></span>
<span><span class="co">#&gt; [7] MAX_3600 (8760 rows)</span></span>
<span><span class="co">#&gt; [8] AVERAGE_86400 (1825 rows)</span></span>
<span><span class="co">#&gt; [9] MIN_86400 (1825 rows)</span></span>
<span><span class="co">#&gt; [10] MAX_86400 (1825 rows)</span></span></code></pre></div>
<p>This output tells you that metrics are collected every 60 seconds (one minute), and then in selected multiples (1 minute, 5 minutes, 1 hour and 1 day.) You can also tell that the consolidation functions are <code>average</code>, <code>min</code> and <code>max</code>.</p>
<p>To extract one month of data, averaged at 5-minute intervals use <code>step = 300</code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cpu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">rrd_location</span>, <span class="st">"cpu-0.rrd"</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_rra.html">read_rra</a></span><span class="op">(</span><span class="va">cpu</span>, cf <span class="op">=</span> <span class="st">"AVERAGE"</span>, step <span class="op">=</span> <span class="fl">300L</span>, n_steps <span class="op">=</span> <span class="op">(</span><span class="fl">3600</span> <span class="op">/</span> <span class="fl">300</span><span class="op">)</span> <span class="op">*</span> <span class="fl">24</span> <span class="op">*</span> <span class="fl">30</span>, end <span class="op">=</span> <span class="va">end_time</span><span class="op">)</span></span>
<span><span class="va">dat</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8,640 × 9</span></span></span>
<span><span class="co">#&gt;    timestamp             user     sys  nice  idle     wait   irq softirq  stolen</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2018-04-02 <span style="color: #949494;">00:05:00</span> 0.016<span style="text-decoration: underline;">2</span> 0.008<span style="text-decoration: underline;">21</span>     0 0.975 0            0 0   <span style="color: #949494;"> </span>   8.22<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2018-04-02 <span style="color: #949494;">00:10:00</span> 0.022<span style="text-decoration: underline;">1</span> 0.009<span style="text-decoration: underline;">88</span>     0 0.967 0            0 0   <span style="color: #949494;"> </span>   8.19<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2018-04-02 <span style="color: #949494;">00:15:00</span> 0.044<span style="text-decoration: underline;">8</span> 0.018<span style="text-decoration: underline;">6</span>      0 0.934 0.001<span style="text-decoration: underline;">24</span>      0 4.14<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 1.24<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2018-04-02 <span style="color: #949494;">00:20:00</span> 0.017<span style="text-decoration: underline;">7</span> 0.008<span style="text-decoration: underline;">16</span>     0 0.974 0            0 0   <span style="color: #949494;"> </span>   0   <span style="color: #949494;"> </span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2018-04-02 <span style="color: #949494;">00:25:00</span> 0.028<span style="text-decoration: underline;">5</span> 0.007<span style="text-decoration: underline;">99</span>     0 0.963 0.000<span style="text-decoration: underline;">411</span>     0 0   <span style="color: #949494;"> </span>   4.10<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2018-04-02 <span style="color: #949494;">00:30:00</span> 0.140  0.009<span style="text-decoration: underline;">10</span>     0 0.850 0            0 0   <span style="color: #949494;"> </span>   8.47<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2018-04-02 <span style="color: #949494;">00:35:00</span> 0.015<span style="text-decoration: underline;">1</span> 0.015<span style="text-decoration: underline;">1</span>      0 0.969 0.000<span style="text-decoration: underline;">351</span>     0 0   <span style="color: #949494;"> </span>   3.84<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2018-04-02 <span style="color: #949494;">00:40:00</span> 0.056<span style="text-decoration: underline;">5</span> 0.009<span style="text-decoration: underline;">42</span>     0 0.929 0.004<span style="text-decoration: underline;">91</span>      0 0   <span style="color: #949494;"> </span>   0   <span style="color: #949494;"> </span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2018-04-02 <span style="color: #949494;">00:45:00</span> 0.024<span style="text-decoration: underline;">1</span> 0.008<span style="text-decoration: underline;">35</span>     0 0.967 0            0 0   <span style="color: #949494;"> </span>   8.50<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2018-04-02 <span style="color: #949494;">00:50:00</span> 0.025<span style="text-decoration: underline;">1</span> 0.011<span style="text-decoration: underline;">1</span>      0 0.963 0            0 0   <span style="color: #949494;"> </span>   7.95<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 8,630 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ Use `print(n = ...)` to see more rows</span></span></span></code></pre></div>
<p>It is very easy to plot this using your preferred plotting package, e.g., <code>ggplot2</code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">timestamp</span>, y <span class="op">=</span> <span class="va">`user`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>, span <span class="op">=</span> <span class="fl">0.05</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 1 rows containing non-finite values (stat_smooth).</span></span></code></pre></div>
<p><img src="using_rrd_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>The <code>rrd</code> package, available from <a href="https://github.com/andrie/rrd" class="external-link">GitHub</a>, makes it very easy to read metrics stored in the RRD database format. Reading an archive is very quick, and your resulting data is a <code>tibble</code> for an individual archive, or a list of <code>tibble</code>s for the entire file.</p>
<p>This makes it easy to analyze your data using the <code>tidyverse</code> packages, and to plot the information.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Andrie de Vries, Plamen Dimitrov.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
